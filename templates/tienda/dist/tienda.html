{% extends "plantilla_tienda.html" %}
{% load static %}
{% block title %}Tienda - Prestige{% endblock %}
{% block tienda %}
{% load carrito %}
<div class="container-fluid "  >
  <div class="row justify-content-center p-0">
    <div class="col-12 p-0 ">
      <!--<img class="card-img-top" src="/media/intro/super.jpg" alt="Foto producto" style="width:100%; ">  |
      -->
      <div id="demo" class="carousel slide" data-ride="carousel">
        <ul class="carousel-indicators">
          <li data-target="#demo" data-slide-to="0" class="active"></li>
          <li data-target="#demo" data-slide-to="1"></li>
          <li data-target="#demo" data-slide-to="2"></li>
        </ul>
        <div class="carousel-inner">
          {% for tienda_carrouselle in tienda_carrouselle|slice:"0:1" %}
          <div class="carousel-item active">
            <img src="/media/{{tienda_carrouselle.imagen}}" alt="Los Angeles" width="100%">
            <div class="carousel-caption">
              <h3>{{tienda_carrouselle.titulo}}</h3>
              <p>{{tienda_carrouselle.descripcion}}</p>
            </div>   
          </div>
          {% endfor %}

          {% for tienda_carrouselle in tienda_carrouselle|slice:"1:3" %}

          <div class="carousel-item ">
            <img src="/media/{{tienda_carrouselle.imagen}}" alt="Los Angeles" width="100%">
            <div class="carousel-caption">
              <h3>{{tienda_carrouselle.titulo}}</h3>
              <p>{{tienda_carrouselle.descripcion}}</p>
            </div>   
          </div>
          {% endfor %}




 
        </div>
        <a class="carousel-control-prev" href="#demo" data-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </a>
        <a class="carousel-control-next" href="#demo" data-slide="next">
          <span class="carousel-control-next-icon"></span>
        </a>
      </div>    
    
    
    
    
    
    </div>
  </div>
</div> 

<div id="menu_lateral">
{% include "menu.html" with  elementos_menu=elementos_menu  %}
</div>

<div id="lateral_mm" >
{% include "minorista_mayorista.html" with  user=user clave_mayorista_usuario=clave_mayorista_usuario clave_mayorista=clave_mayorista %}
</div>

<div id="mi_carrito" >
{% include "ir_carrito.html" %}
</div>
<div class="container">
  <div class="row">
    <div class="col-12">
       <br/>
    </div>
  </div>
</div>

<div class="container mt-3">
  <div class="row">
    <!-- *********************************
    * MENÚ
    ********************************** -->
    
    <!-- *********************************
    * PÁGINA
    ********************************** -->
 
    <div id="productos" class="col-lg-10 mx-auto p-0 ">
      <div class="row">
        <div id = "ruta_tienda" class="col-12">
          {% if ruta_en_tienda_categoria %}
            {{ruta_en_tienda_categoria|upper}}
            {% if ruta_en_tienda_tipologia %} 
              |  {{ruta_en_tienda_tipologia|upper}} 
              {% if ruta_en_tienda_talle %} 
              | TALLE: {{ruta_en_tienda_talle}}
              {% endif %}
            {% endif %}
          {% endif %}
          </div>
      </div>
      
 

      <div class="row mx-auto">
        {% for producto in productos %}

        <div class="col-12 col-sm-6 col-md-4 p-2"> 
          <div class="prod_dest card border-0 mx-auto mb-3 mi_contenedor_imagen  cont_img" >
            <a href="{% url 'ver_producto' articulo=producto.articulo %}"  >
              <div class="bg-image hover-zoom">
              <img class="card-img-top" src="/media/{{producto.imagen}}" alt="Foto producto" style="width:100%; ">
              </div>  
            </a>
            <!--
            <button class="btn   mi_whatsapp " >
              <a href="https://api.whatsapp.com/send?phone=1524563277" class="btn-wsp" target="_blank">
                <i class="icon-whatsapp"></i>
              </a>
            </button>
            -->
            <button class="btn mi_quick_view  " data-toggle="modal" data-target="#p{{producto.id}}">Vista Rápida</button>
            <div class="card-body p-2 ">
                <p class="card-text text-center">
                <b>{{producto.nombre}}</b> &nbsp;&nbsp;
                {% if clave_mayorista_usuario == clave_mayorista %}
                  ${{producto.precio_mayorista}}
                {% else %}
                  ${{producto.precio}}
                {% endif %}                
                &nbsp;&nbsp; 
                </p>  
            </div>     
          </div>
        </div>
        
        <!-- ***********************************************************************************
          *************** Modal 
        ************************************************************************************* -->
        <div id="p{{producto.id}}" class="modal fade" role="dialog">
          <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">{{producto.nombre}}</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
              </div>
              <div class="modal-body">
                <div class ="row">
                  <!--******************************************************
                  * IMAGENES DEL COSTADO
                  * ****************************************************-->
                  <div class="col-2 col-md-2">
                    {% for imagenes in imagenes%}
                      {% if producto.id == imagenes.producto.id %}
                        <img class="card-img-top pb-1 img_lat" src="/media/{{imagenes.imagen}}" alt="{{imagenes.nombre}}" style="width:100%; ">
                      {% endif %}
                    {% endfor %}
                  </div>
                  
                  <!--******************************************************
                  * IMAGEN Y DATOS DE COSTO
                  * ****************************************************-->
                  <div id="img_sup" class="col-10 col-md-5  ">
                    <div  class="d-block d-md-none d-lg-none">
                      <img src="/media/{{producto.imagen}}" alt="{{producto.nombre}}" style="width:100%; ">
                    </div>                                     
                    <div  class=" img-zoom-container  d-none d-md-block d-lg-block">
                      <div class="img-zoom-lens card-img-top pb-1 card-img-top">
                        <img class="img_zom" src="/media/{{producto.imagen}}" alt="{{producto.nombre}}" style="width:100%; ">
                        <div class="img-zoom-result " ></div>
                      </div>
                    </div>
                  </div>

                  <!--******************************************************
                  * SELECCIÓN DE PRODUCTO PARA CARRITO
                  * ****************************************************-->
                  <div class="col-12 col-md-5">
                    <div class="card-body p-2 ">
                      <p class="card-text text-center">Tipología:&nbsp; {{producto.tipologia}}</p>
                      <hr/>
                      <p class="card-text text-center">Descripción:&nbsp; {{producto.descripcion}}</p>
                      <hr/>
                    </div>  
                    <div class="card-body p-2 d-none  d-lg-block ">
                      <p class="card-text text-center">
                        {%for catimg in producto.categoria.all %}
                          {% if catimg.nombre == "Diamond" or catimg.nombre == "Essencial" or catimg.nombre == "Jogger" or catimg.nombre == "Luxury" or catimg.nombre == "Sport Action"%}
                            Línea:&nbsp;<img class="card-img-top" src="/media/{{catimg.imagen}}" alt="Foto producto" style="width:30%; ">
                          {% endif %}
                        {% endfor %}
                      </p>
                      <hr/>
                      <p class="card-text text-center">Tejido:&nbsp; {{producto.tejido}}</p>
                      <hr/>
                      <p class="card-text text-center">Composición:&nbsp; {{producto.composicion}}</p>  
                    </div>  
                  </div>
                  <div class="col-12 col-md-12">
                    <div class="col-12 col-md-12 mb-4 d-block   d-lg-none ">
                      <p class="card-text text-center">
                        {%for catimg in producto.categoria.all %}
                          {% if catimg.nombre == "Diamond" or catimg.nombre == "Essencial" or catimg.nombre == "Jogger" or catimg.nombre == "Luxury" or catimg.nombre == "Sport Action"%}
                            Línea:&nbsp;<img class="card-img-top" src="/media/{{catimg.imagen}}" alt="Foto producto" style="width:30%; ">
                          {% endif %}
                        {% endfor %}
                      </p>
                      <hr/>
                      <p class="card-text text-center">Tejido:&nbsp; {{producto.tejido}}</p>
                      <hr/>
                      <p class="card-text text-center">Composición:&nbsp; {{producto.composicion}}</p>  
                    </div>
                    <div class="col-12 col-md-12 mb-4">
                      <button type="button" class="btn btn-danger lista_talles" style="width:100%;">Lista de Talles</button>
                    </div>
                    <div class="col-12 col-md-12 ver_talles">
                      <img class="card-img-top" src="/media/tablas/tabla_talles.jpg" alt="Foto producto" style="width:100%; ">
                      <hr/>
                    </div>
                    <div class="col-12 col-md-12">
                      <button type="button" class="btn btn-danger lista_cuidados" style="width:100%;">Cuidados</button>
                    </div>
                    <div class="col-12 col-md-12 ver_cuidados">
                      <table class="table  table-hover text-center">
                        <tbody>
                          {% for cuidados in cuidados %}
                            {% if cuidados.producto.id == producto.id %}
                              <tr><td>{{cuidados.cuidado}}</td></tr>
                            {% endif %}
                          {% endfor %}
                        </tbody>
                      </table>
                      <hr/>
                    </div>

                    <hr/>
                    <form class="form_talle">

                          <div class ="row  ">
                              <div class="d-inline text-center col-3 pt-1"  >
                                  <b>Color</b>
                              </div> 
                              <div class="d-inline text-center col-3 pt-1"  >
                                  <b>Talle</b>
                              </div> 
                              <div class="d-inline text-center col-3 pt-1"  >
                                  <b>$</b>
                              </div> 
                              <div class="d-inline text-center col-3 pt-1"  >
                                  <b><span class="icon-carrito"></span></b>
                              </div> 
                          </div>
                        
                          {% for colores in colores %}
                          {% for cada_producto in cada_producto %} 
                            {% if cada_producto.articulo == producto.articulo %}  
                              {% if cada_producto.color == colores.nombre %}
                              <div class ="row ver_stock">
                                <div class="div_ver"> 
                                  <p><b>Quedan en stock: &nbsp;</b> {{cada_producto.stock}}</p>
                                  <hr/>
                                  <p>
                                    <b>Este producto tiene un descunto del: &nbsp;</b> 
                                    {% if clave_mayorista_usuario == clave_mayorista %}
                                      ${{cada_producto.descuento_mayorista}}
                                    {% else %}
                                      {{cada_producto.descuento}}%
                                    {% endif %} 
                                  </p>
                                </div>

                                <div class="d-inline text-center col-3 pt-1" >
                                  <span class="color_muestra" style="background-color:{{colores.hexadecimal}};">
                                  &nbsp;&nbsp;&nbsp;&nbsp;
                                  </span>&nbsp;&nbsp;&nbsp;{{colores.nombre}}
                                </div>
                                <div class="d-inline text-center col-3 pt-1"  >
                                  {{cada_producto.talle}}
                                </div>                                       
                                <div class="d-inline text-center col-3 pt-1"  >
                                  {% if clave_mayorista_usuario == clave_mayorista %}
                                  {{cada_producto.precio_mayorista}}<!--{{cada_producto|precio_total_producto_mayorista:request.session.carro}}-->
                                  {% else %}
                                  {{cada_producto.precio}}    <!--{{cada_producto|precio_total_producto:request.session.carro}}-->
                                  {% endif %}  
                                  
                                </div>   
                                <div class="d-inline text-center col-3 pt-1"  >
                                  <input type="submit"  hidden class="col-12 vervalor" value="1"/>
                                  <input type="submit"  hidden class="col-12 verid" value="prestige_{{cada_producto.id}}"/>
                                  <input type="radio" hidden class="{{cada_producto.id}}" name="ratio_talle" value="{{cada_producto.id}}"> 
                                  <button type="button" class="btn btn-info btn-sm agregar_i cp_prestige_{{cada_producto.id}} " style="width:100%;"><span class="icon-carrito"></span>Agregar</button>
                                </div> 
                              </div>
                              {% endif %}
                            {% endif %}
                          {% endfor %}
                          {% endfor %}
                          <div class ="row  ">
                              <div class="d-inline text-center col-12 pt-1"  >  
                                <hr/>
                              </div> 
                          </div>
                      <button type="button" class="btn btn-danger btn-sm boton_carrito" style="width:100%;"><span class="icon-carrito"></span>Ir a Carrito</button>  
                    </form>
                    <hr/>  
                  </div>
                  <div class="col-12 col-md-12">
                    <center><h3>Completa tu Look</h3></center>
                  </div>                  


                  <div class="col-12 col-md-12">
                    <div class="row justify-content-center ">
                    {% for producto_asociado in producto_asociado %}
                      {% if producto_asociado.producto.articulo == producto.articulo %}
 
                        <div class="d-inline mi_lista_menu1 mt-3 col-2" >
                          <a  class="pt-1 pb-1 pl-3 pr-3 " href="{% url 'ver_producto' articulo=producto_asociado.articulo %}" >
                            <img class="card-img-top" src="/media/{{producto_asociado|retornar_imagen}}" alt="Foto producto" style="width:100%; ">
                          </a>
                        </div>
 
                      {% endif %}
                    {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div> 
        <!-- ***********************************************************************************
          *************** FIN Modal 
        ************************************************************************************* -->
        {% endfor %}
      </div>
    </div>   
  </div>
</div>














<div class="container">
  <div class="row">
    <div class="col-12"  >
      <br/><br/><br/> 
    </div>
  </div>
</div>
 
{% endblock %}
{% block javascript %}
<script src="https://cdn.jsdelivr.net/jquery.cookie/1.4.1/jquery.cookie.min.js"></script> 
<script type="text/javascript" src="{% static 'js/juan_ajax.js' %}"></script>
<script type="text/javascript" src="{% static 'js/minified/gsap.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/minified/ScrollTrigger.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/main.js' %}"></script>


<script>
const burgerLines = document.querySelectorAll('.prod_dest')

burgerLines.forEach((prod_dest) => {
  prod_dest.addEventListener('mouseover', (e) => {
    console.log('The burger is hovered')
    TweenMax.to(prod_dest, 0.2, {
      scaleX:1.05, scaleY:1.05, scaleZ:1.3,
    })
  })
  prod_dest.addEventListener('mouseout', (e) => {
    console.log('The burger is hovered')
    TweenMax.to(prod_dest, 0.2, {
      scaleX:1, scaleY:1, scaleZ:1,
    })
  }) 
})
</script>






<script>
/*
  const items = { ...localStorage };
  console.log(items);
  Crear(items);
*/
</script>
<script>
 

$(".cont_img").mouseover(function() {
  $(this).parent().find('.mi_quick_view').css({
      "display": "block",

    });
});
$(".cont_img").mouseout(function() {
  $(this).parent().find('.mi_quick_view').css({
      "display": "none",

    });
});
</script>
<script>
  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })
</script>



<script>
  /*
   $(".menu_a_t").css({
      "background-color": "red",
      "font-weight": "bolder"
    });
*/
    $('.menu_a_t').click(function() {
      $(this).parent().find('.menu_div_t').toggle();
 
    });

    $('.lista_talles').click(function() {
      $(this).parent().parent().parent().parent().find('.ver_talles').toggle();
 
    });
    $('.lista_cuidados').click(function() {
      $(this).parent().parent().parent().parent().find('.ver_cuidados').toggle();
 
    });

</script>
<script>
  for(i = 0; i < localStorage.length; i++){
    let clave = localStorage.key(i);
    let valcp;
    valcp = ".cp_" + clave.toString()
    console.log("qqqqqqqqqqqqqqqqqqq");
    console.log(valcp);
    $( valcp ).attr("disabled", true);
  }

</script>
<script>
  $('.img_lat').click(function() {
      
      let images = $(this).attr('src');
      console.log(images);
      $(this).parent().parent().find('#img_sup img').attr("src",images);//      .html("hola");
      
 //<img class="card-img-top pb-1 img_lat" src="/media/{{imagenes.imagen}}" alt="{{imagenes.nombre}}" style="width:100%; ">
  });
</script>
<script>
  $('.img_zom').mouseover(function() {
    
    let img, lens, result, cx, cy, ancho, alto;
    lens = $(this).parent().parent().find('.img-zoom-lens');
    result = $(this).parent().parent().find('.img-zoom-result');
    img = $(this);

    ancho = img.width();
    alto = img.height();
    console.log("!!!!!");
    console.log(img);
    console.log(ancho);
    console.log(alto);
    console.log("!!!!!");


    console.log(result);
    result.css({
      "display": "block",
    });

    /* Calculate the ratio between result DIV and lens: */
    cx = result.width() / lens.width();
    cy = result.height() / lens.height();
    console.log(cx)
    console.log(cy)
    cx = 4;
    cy = 4;
    /* Set background properties for the result DIV */
    result.css('background-image', 'url(' + $(this).attr("src") + ')');
    result.css("background-size",(ancho*cx)+"px " + (alto*cy) + "px");
    
    img.on( "mousemove touchmove", function(e) {
      let pos, x, y, offset;
      offset = $(this).offset();
      e.preventDefault();
      //console.log( e.target );
      console.log("holaaaaaa");
      x = e.pageX - offset.left
      y = e.pageY - offset.top
      console.log(e.pageX - offset.left);
      console.log(e.pageY - offset.top);
      xr = -x
      yr = -y
      console.log(xr);
      console.log(yr);
      result.css({'background-repeat': 'no-repeat'});

      result.css("background-position",(xr*cx)+"px " + (yr*cy) + "px");
      //result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";




    } );





}).mouseout(function() {
    $('.img-zoom-result').css({
    "display": "none",
  });
});

</script>

<script>
$(' .div_ver').css({
      "display": "none",
    });

$( ".ver_stock").mouseover(function() {
  $(this).find('.div_ver').css({
      "display": "block",
    });
  $(this).css({
    "background-color": "#e8e8e8",
  });  
});
$( ".ver_stock").mouseout(function() {
  $(this).find('.div_ver').css({
      "display": "none",
  });
  $(this).css({
    "background-color": "#fff",
  }); 
});

</script>

<script>
$("#abrir_lateral").click(function(){
  $("#abrir_lateral").css({"display":"none"});
  $("#cerrar_lateral").css({"display":"block"});
  $("#menu_l").css({"display":"block"});
});
$("#cerrar_lateral").click(function(){
  $("#cerrar_lateral").css({"display":"none"});
  $("#abrir_lateral").css({"display":"block"});
  $("#menu_l").css({"display":"none"});
});
$("#menu_lateral_exclusivo").click(function(){
  $("#menu_exclusivo").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_lo_nuevo").click(function(){
  $("#menu_lo_nuevo").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_volvio_entrar").click(function(){
  $("#menu_volvio_entrar").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_diamond").click(function(){
  $("#menu_diamond").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_essencial").click(function(){
  $("#menu_essencial").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_jogger").click(function(){
  $("#menu_jogger").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_luxury").click(function(){
  $("#menu_luxury").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$("#menu_lateral_sport_action").click(function(){
  $("#menu_sport_action").css({"display":"block"});
  $("#menu_principal_over").css({"display":"block"});
  $(".menu_cat").css({"display":"none"});
});
$(".menu_lateral_cerrarcat").click(function(){
  $("#menu_exclusivo").css({"display":"none"});
  $("#menu_lo_nuevo").css({"display":"none"});
  $("#menu_volvio_entrar").css({"display":"none"});
  $("#menu_diamond").css({"display":"none"});
  $("#menu_essencial").css({"display":"none"});
  $("#menu_jogger").css({"display":"none"});
  $("#menu_luxury").css({"display":"none"});
  $("#menu_sport_action").css({"display":"none"});  
  $("#menu_principal_over").css({"display":"none"});
  $(".menu_cat").css({"display":"block"});
});
/*
#menu_esclusivo, #menu_lo_nuevo, #menu_volvio_entrar,
#menu_diamond, #menu_essencial, #menu_jogger,
#menu_luxury, #menu_sport_action
*/

</script>
{% endblock %}